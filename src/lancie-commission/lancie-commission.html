<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/lancie-ajax/lancie-ajax.html">

<link rel="import" href="../../bower_components/paper-material/paper-material.html">

<link rel="import" href="lancie-commission-member.html">
<dom-module id="lancie-commission">
  <template>
    <style include="iron-flex iron-flex-alignment"></style>
    <style>
      :host {
        display: block;
      }

      p {
        margin-top: 0;
      }

      .textual, .visual {
        display: inline-block;
      }

      .textual {
        margin-right: 16px;
        max-width: 40%;
      }

      .visual {
        max-width: calc(60% - 16px);
      }

      @media (max-width: 950px) {
        .textual, .visual {
          max-width: 100%;
        }
      }
    </style>

    <lancie-ajax
      id="ajaxCommittee"
      refurl="web/committee"
      handle-as="json"
      on-response="onCommittee"></lancie-ajax>

    <div class="layout horizontal wrap">
      <div class="textual">
        <p>The LANcie is the committee that organizes Area FiftyLAN each
          year. It's our job to make sure everything goes to plan and that
          all potential problems are taken care of. We don't bite, so don't hesitate
          to contact us with a good story, some questions or just a casual
          conversation about gaming. We're always open to feedback and fun
          ideas. We hope to see you at the event!</p>
        <p>If you have any questions or are interested in sponsoring the
          event, please send an email with our <a href="/contact">contact form</a>.</p>
      </div>
      <div class="visual">
        <div class="layout horizontal wrap start-justified">
          <template is="dom-repeat" items="[[commission]]" as="commissioner" sort="_computeSort">
            <lancie-commission-member commissioner="[[commissioner]]"></lancie-commission-member>
          </template>
        </div>
      </div>
    </div>

  </template>
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'lancie-commission',
        properties: {
          commission: {
            type: Array,
            value: []
          }
        },

        attached: function() {
          this.$.ajaxCommittee.generateRequest();
        },

        onCommittee: function(e, request) {
          if (request.succeeded) {
            this.commission = request.response.object;
          }
        },

        _computeSort: function(a, b) {
          if (a.position === b.position) {
            return 0;
          }
          return a.position > b.position ? 1 : -1;
        }
      });
    })();
  </script>
</dom-module>
